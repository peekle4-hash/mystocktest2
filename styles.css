*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Apple SD Gothic Neo','Noto Sans KR',sans-serif;margin:0;background:#f6f7fb;color:#111}
header{padding:22px 18px;background:#0f172a;color:#fff}
h1{margin:0 0 6px 0;font-size:20px}
.sub{margin:0;color:#cbd5e1;font-size:13px}
main{max-width:1240px;margin:18px auto;padding:0 14px;display:flex;flex-direction:column;gap:14px}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:14px}
.card.small{padding:10px}
.row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.grow{flex:1}
.btns{display:flex;gap:8px;flex-wrap:wrap}
button,.file{border:1px solid #d1d5db;background:#111827;color:#fff;border-radius:10px;padding:9px 10px;font-weight:800;cursor:pointer}
button.secondary,.file.secondary{background:#fff;color:#111827}
button.danger{background:#b91c1c;border-color:#b91c1c}
.file{position:relative;overflow:hidden;display:inline-flex;align-items:center;gap:8px}
.file input{position:absolute;inset:0;opacity:0;cursor:pointer}
label{display:block;font-size:12px;color:#334155;margin-bottom:6px}
input[type="date"],input[type="text"],input[type="number"],select{border:1px solid #d1d5db;border-radius:10px;padding:9px 10px;font-size:14px}
input[type="number"]{width:120px}
select{padding:9px 10px}
.hint{color:#64748b;font-size:12px;margin-left:6px}
.note{margin-top:10px;color:#64748b;font-size:12px}

.table-wrap{overflow:auto;border:1px solid #e5e7eb;border-radius:10px}
.table-wrap.mini table{min-width:980px}
.table-wrap.data-entry{max-height:420px;overflow:auto}
@media (max-width:900px){.table-wrap.data-entry{max-height:320px} .table-wrap.mini table{min-width:900px}}

table{border-collapse:collapse;width:100%;min-width:1180px}
th,td{border-bottom:1px solid #e5e7eb;padding:10px 8px;text-align:center;font-size:13px;white-space:nowrap}
th{background:#f1f5f9;color:#0f172a;position:sticky;top:0;z-index:1}
tbody tr:hover{background:#fafafa}

.kpi-grid{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:10px;margin-top:12px}
@media (max-width:1100px){.kpi-grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
@media (max-width:900px){.kpi-grid{grid-template-columns:repeat(2,minmax(0,1fr))}}

.kpi{border:1px solid #e5e7eb;border-radius:12px;padding:10px;position:relative;box-shadow:0 1px 0 rgba(15,23,42,0.03),0 6px 18px rgba(15,23,42,0.06)}
.kpi::before{content:"";position:absolute;left:0;right:0;top:0;height:4px;border-top-left-radius:12px;border-top-right-radius:12px;background:#e5e7eb}
.kpi-all{background:#fff7e6}
.kpi-isa{background:#eef6ff}
.kpi-gen{background:#fff2f2}
.kpi-all::before{background:#f59e0b}
.kpi-isa::before{background:#3b82f6}
.kpi-gen::before{background:#ef4444}
.kpi-title{font-size:12px;color:#64748b;margin-bottom:6px;font-weight:800}
.kpi-val{font-size:18px;font-weight:900}
.kpi-val.pos{color:#16a34a}
.kpi-val.neg{color:#dc2626}
.kpi-val.zero{color:#64748b}

.h3{margin:0;font-size:14px}
.summary-row{margin-top:6px}
.seg{display:inline-flex;border:1px solid #d1d5db;border-radius:12px;overflow:hidden;margin-left:8px}
.seg-btn{border:0;background:#fff;color:#111827;padding:8px 10px;font-weight:800;cursor:pointer}
.seg-btn.active{background:#111827;color:#fff}

.charts{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:12px}
@media (max-width:900px){.charts{grid-template-columns:1fr}}
.chart{border:1px solid #e5e7eb;border-radius:12px;padding:10px;overflow:hidden}
.chart canvas{width:100%!important;height:320px!important}
@media (max-width:900px){.chart canvas{height:280px!important}}

footer{padding:16px 18px;color:#64748b;font-size:12px;text-align:center}
.small summary{cursor:pointer;font-weight:800}

/* 날짜별 접기/펼치기 */
tr.date-group-row td{background:#111827!important;color:#fff;font-weight:900;text-align:left}
.date-group{display:flex;align-items:center;gap:10px}
.date-pill{background:rgba(255,255,255,0.14);padding:4px 10px;border-radius:999px;font-size:12px}
.toggle-btn{border:1px solid rgba(255,255,255,0.35);background:transparent;color:#fff;border-radius:999px;padding:4px 10px;font-weight:900;cursor:pointer}
tr.group-hidden{display:none}
.group-totals{display:flex;gap:10px;flex-wrap:wrap;margin-left:auto;font-size:12px;opacity:.95}
.group-totals span{background:rgba(255,255,255,0.12);padding:4px 10px;border-radius:999px}

/* 행 액션 */
.row-actions{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.row-actions button{padding:6px 8px;border-radius:10px;font-weight:900;font-size:12px}
.row-actions button.secondary{background:#fff;color:#111827;border:1px solid #d1d5db}
.row-actions button.mini-danger{background:#b91c1c;border-color:#b91c1c;color:#fff}

/* 월별 표 구분 */
#monthlyTable th:nth-child(n+2):nth-child(-n+4),
#monthlyTable td:nth-child(n+2):nth-child(-n+4){background:#eef6ff}  /* ISA */
#monthlyTable th:nth-child(n+5):nth-child(-n+7),
#monthlyTable td:nth-child(n+5):nth-child(-n+7){background:#fff2f2}  /* 일반 */
#monthlyTable th:nth-child(n+8):nth-child(-n+10),
#monthlyTable td:nth-child(n+8):nth-child(-n+10){background:#fff7e6} /* 전체 */

/* 누적(마지막 3칸) */
#monthlyTable th:nth-child(11), #monthlyTable td:nth-child(11){background:#eef6ff}  /* ISA 누적 */
#monthlyTable th:nth-child(12), #monthlyTable td:nth-child(12){background:#fff2f2}  /* 일반 누적 */
#monthlyTable th:nth-child(13), #monthlyTable td:nth-child(13){background:#fff7e6}  /* 전체 누적 */

/* 그룹 구분선 */
#monthlyTable th:nth-child(2),  #monthlyTable td:nth-child(2),
#monthlyTable th:nth-child(5),  #monthlyTable td:nth-child(5),
#monthlyTable th:nth-child(8),  #monthlyTable td:nth-child(8),
#monthlyTable th:nth-child(11), #monthlyTable td:nth-child(11){border-left:2px solid #cbd5e1}

/* 헤더는 조금 더 진하게 */
#monthlyTable thead th:nth-child(n+2):nth-child(-n+4){background:#dbeafe}
#monthlyTable thead th:nth-child(n+5):nth-child(-n+7){background:#fee2e2}
#monthlyTable thead th:nth-child(n+8):nth-child(-n+10){background:#ffedd5}
#monthlyTable thead th:nth-child(11){background:#dbeafe}
#monthlyTable thead th:nth-child(12){background:#fee2e2}
#monthlyTable thead th:nth-child(13){background:#ffedd5}

/* ===== ISA/일반 KPI 4칸 그리드 ===== */
.kpi-grid-3{
  display:grid;
  grid-template-columns:repeat(4,minmax(0,1fr)); /* 4칸 */
  gap:10px;
  margin-top:12px;
}
@media (max-width:900px){
  .kpi-grid-3{grid-template-columns:repeat(2,minmax(0,1fr))}
}

/* ===== 컴팩트 UI ===== */
.table-wrap.data-entry{
  margin-top: 32px;
  max-height:480px;
  overflow-y:auto;
  overflow-x:hidden;   /* 가로스크롤 제거 */
}

table{
  min-width:unset !important;
}

th,td{
  padding:6px 6px;      /* 행 간격 줄임 */
  font-size:12px;
}

input[type="text"],
input[type="number"],
input[type="date"],
select{
  padding:5px 6px;
  font-size:12px;
  width:100%;
  min-width:60px;
}

.row-actions button{
  padding:4px 6px;
  font-size:11px;
}

@media (max-width:1200px){
  table{min-width:unset !important;}
}

/* 종가 일괄 입력 */
.bulk-box{width:100%}
textarea{width:100%;border:1px solid #d1d5db;border-radius:10px;padding:10px;font-size:13px;resize:vertical}
#closeTable{min-width:420px}
#closeTable input[type="number"]{width:160px}
